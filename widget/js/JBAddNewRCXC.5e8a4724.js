(function(t){function e(e){for(var o,a,s=e[0],f=e[1],c=e[2],d=0,l=[];d<s.length;d++)a=s[d],i[a]&&l.push(i[a][0]),i[a]=0;for(o in f)Object.prototype.hasOwnProperty.call(f,o)&&(t[o]=f[o]);u&&u(e);while(l.length)l.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var f=n[s];0!==i[f]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={JBAddNewRCXC:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],f=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=f;r.push([23,"chunk-vendors","chunk-common"]),n()})({23:function(t,e,n){t.exports=n("4000")},4e3:function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ocn-background"),n("ocn-header",{attrs:{title:t.isEdit?"日常巡查详情":"新增日常巡查",center:!0}},[n("div",{staticClass:"title-left",attrs:{slot:"left"},on:{click:function(e){return t.back()}},slot:"left"},[n("i",{staticClass:"cubeic-back"})]),t._e()]),n("div",[n("ocn-form",{ref:"ocnform1",attrs:{isEdit:t.isEdit},on:{submit:t.submitOne}}),n("div",{staticClass:"blanks"}),n("ocn-form",{ref:"ocnform2",attrs:{isEdit:t.isEdit},on:{submit:t.submitTwo}}),n("ocn-file",{ref:"ocnFile",attrs:{isEdit:t.isEdit,title:"问题照片",type:["photo"],maximum:"50"}}),t.isEdit?t._e():n("div",{staticClass:"Various_btn"},[n("div",{on:{click:t.submitForm}},[t._v("提交")])])],1)],1)},i=[],r=(n("8e6e"),n("456d"),n("bd86")),a=(n("ac6a"),function(){return{f:{registTime:"",title:"",reportContent:""},show:[{text:"巡查时间",value:"registTime",validate:!0,type:"date",warn:!1,min:new Date(1949,1,1),columnCount:3,readonly:!0},{text:"标题",value:"title",type:"text",validate:!0,warn:!1},{text:"问题内容",value:"reportContent",type:"text",validate:!0,warn:!1}]}});function s(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(n,!0).forEach(function(e){Object(r["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var c={data:function(){var t=this;return{token:JSON.parse(this.getData("userinfo")).data,JBAddInfo:{f:{areaId:"",greenAreaName:"",registUnit:"",mappointX:"",mappointY:"",inspectManageNumber:""},show:[{text:"所属地块",value:"areaId",type:"click",validate:!0,warn:!1,placeholder:"请选择地块",callback:function(){var e=t,n=[];e.JBList.forEach(function(t,e){n.push({text:t.attributes.LDMC,value:e})}),e.$createPicker({title:"选择地块名称",data:[n],onSelect:function(t,n,o){e.getIMNumber(),e.JBAddInfo.f.areaId=e.JBList[t[0]].attributes.WGMC,e.JBAddInfo.f.greenAreaName=o[0],e.JBAddInfo.f.registUnit=e.slow.getItem("login").userName;var i=e.JBList[t[0]].geometry.rings[0][0];e.JBAddInfo.f.mappointX=i[0],e.JBAddInfo.f.mappointY=i[1]}}).show()}},{text:"反映人",value:"registUnit",type:"text",validate:!0,warn:!1}]},isEdit:JSON.parse(this.getData("JBProblemEdit"))||!1,JBId:this.getData("JBProblemForm")||"",JBInfo:"",FormOne:!1,FormTwo:!1,JBList:""}},onReady:function(){var t=this;this.isEdit=api.pageParam.isEdit,this.JBId=api.pageParam.id,this.isEdit||(this.JBList=api.pageParam.features),this.$nextTick(function(){t.freshForm()})},created:function(){var t=this;this.$nextTick(function(){t.freshForm()})},methods:{freshForm:function(){var t=this;t.JBAddInfo.f=f({},t.JBAddInfo.f),t.JBAddInfo.show.forEach(function(e){e.valueShow=t.JBAddInfo.f[e.value]}),t.$refs.ocnform1.init(t.JBAddInfo);var e=a();e.f=f({},e.f,{registTime:t.forMat()}),e.show.forEach(function(t){t.valueShow=e.f[t.value]}),t.JBInfo=f({},e),this.$refs.ocnform2.init(e),t.JBId&&(t.get("inspect_manage/get?id="+t.JBId).then(function(n){if(n.success){var o=n.data;o.createTime=t.forMat(o.createTime),o.registTime=o.registTime?t.forMat(o.registTime):t.forMat(o.updateTime),o.updateTime=t.forMat(o.updateTime),t.JBAddInfo.f=f({},t.JBAddInfo.f,{},o),t.JBAddInfo.show.forEach(function(e){e.valueShow=t.JBAddInfo.f[e.value]}),t.$refs.ocnform1.init(t.JBAddInfo),e.f=f({},e.f,{},o),e.show.forEach(function(t){t.valueShow=e.f[t.value]}),t.JBInfo=f({},e),t.$refs.ocnform2.init(e)}}),t.get("inspect_manage/getNodeinfo?id="+t.JBId).then(function(e){if(e.success){if(e.data.nodeList.length<1)return;var n=[],o=t.slow.getInterport().host;e.data.nodeList.forEach(function(t){t.attachList.length<1||t.attachList.map(function(t){n.push(o+"api/profile/"+t.imagePath+t.imageName)})}),t.$refs.ocnFile.addFiles(n)}else t.ocn.warn_toast(t).show("图片获取失败")}))},back:function(){window.api&&api.historyBack(function(t,e){t.status||api.closeWin()})},submitOne:function(t){t?this.FormOne=!0:this.$refs.ocnform1.validate()},submitTwo:function(t){t?this.FormTwo=!0:this.$refs.ocnform2.validate()},submitForm:function(){var t=this;t.submitOne(),t.submitTwo(),t.FormOne&&t.FormTwo&&(t.ocn.loading(t).show("加载中"),t.$refs.ocnFile.upload(t.slow.getInterport().host+"api/inspect_manage/uploadImgs?token="+t.token).then(function(e){e.success?(t.ocn.warn_toast(t).show("图片上传成功"),setTimeout(function(){t.subForm(e.data)},800)):t.ocn.warn_toast(t).show("图片未上传或上传失败")}))},subForm:function(t){var e=this;e.post("inspect_manage/save",{areaId:e.JBAddInfo.f.areaId,inspectManageNumber:e.JBAddInfo.f.inspectManageNumber,registUnit:e.JBAddInfo.f.registUnit,registTime:e.JBInfo.f.registTime,title:e.JBInfo.f.title,reportContent:e.JBInfo.f.reportContent,attacIds:t}).then(function(t){e.ocn.loading(e).hide(),t.success?(e.ocn.warn_toast(e).show("提交成功"),api.closeWin({name:"mapselect"}),api.closeWin({name:"JBProblemHand"}),setTimeout(function(){e.back()},500)):e.ocn.warn_toast(e).show(t.message||"请求失败")})},getIMNumber:function(){var t=this;this.get("/ws_return_info/getuserinfo?_t=1585016434451&type=2").then(function(e){e.data.uunumber&&(t.JBAddInfo.f.inspectManageNumber=e.data.uunumber)})}}},u=c,d=(n("6c31"),n("2877")),l=Object(d["a"])(u,o,i,!1,null,"b30fabe4",null),p=l.exports,m=n("6912");Object(m["a"])(p)},"6c31":function(t,e,n){"use strict";var o=n("b831"),i=n.n(o);i.a},b831:function(t,e,n){}});