(function(a){function t(t){for(var n,r,i=t[0],c=t[1],l=t[2],h=0,d=[];h<i.length;h++)r=i[h],s[r]&&d.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(a[n]=c[n]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),e()}function e(){for(var a,t=0;t<o.length;t++){for(var e=o[t],n=!0,i=1;i<e.length;i++){var c=e[i];0!==s[c]&&(n=!1)}n&&(o.splice(t--,1),a=r(r.s=e[0]))}return a}var n={},s={YHPlanSon:0},o=[];function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return a[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=a,r.c=n,r.d=function(a,t,e){r.o(a,t)||Object.defineProperty(a,t,{enumerable:!0,get:e})},r.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.t=function(a,t){if(1&t&&(a=r(a)),8&t)return a;if(4&t&&"object"===typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&t&&"string"!=typeof a)for(var n in a)r.d(e,n,function(t){return a[t]}.bind(null,n));return e},r.n=function(a){var t=a&&a.__esModule?function(){return a["default"]}:function(){return a};return r.d(t,"a",t),t},r.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},r.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;o.push([19,"chunk-vendors","chunk-common"]),e()})({"0d9a":function(a,t,e){"use strict";var n=e("5efd"),s=e.n(n);s.a},19:function(a,t,e){a.exports=e("963a")},"5efd":function(a,t,e){},"963a":function(a,t,e){"use strict";e.r(t);e("cadf"),e("551c"),e("f751"),e("097d");var n=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("ocn-background"),e("ocn-header",{attrs:{title:"养护计划子项现场养护",center:!0}},[e("div",{staticClass:"title-left",attrs:{slot:"left"},on:{click:function(t){return a.back()}},slot:"left"},[e("i",{staticClass:"cubeic-back"})])]),e("div",[e("ul",{staticClass:"header_Plan"},a._l(a.plans,function(t,n){return e("li",{key:n},[e("span",[a._v(a._s(t.titles))]),e("span",[a._v(a._s(t.val))])])}),0),e("div",{staticClass:"blanks"}),e("ocn-file",{ref:"ocnFile1",attrs:{isEdit:"处理中"===a.yhSonData.ssStatus||a.isEdit,showPic:!a.isEdit,title:"养护前",type:["photo"],maximum:50}}),e("div",{staticClass:"blanks"}),"待处理"!=a.yhSonData.ssStatus?e("ocn-file",{ref:"ocnFile2",attrs:{isEdit:a.isEdit,showPic:!a.isEdit,title:"养护后",type:["photo"],maximum:50}}):a._e(),e("div",{staticClass:"blanks"}),e("ocn-form",{ref:"ocnform",attrs:{isEdit:a.isEdit},on:{submit:a.ChangeColor}}),a.isEdit?a._e():e("ul",{staticClass:"Various_btn"},["待处理"===a.yhSonData.ssStatus||a.handleType?e("li",{staticClass:"activitColor",on:{click:function(t){a.type="保存",a.ChangeColor("待处理"===a.yhSonData.ssStatus)}}},[a._v("保存")]):a._e(),"处理中"===a.yhSonData.ssStatus?e("li",{staticClass:"activitColor",on:{click:function(t){a.type="提交",a.ChangeColor(!1)}}},[a._v("提交")]):a._e()])],1)],1)},s=[],o=(e("8e6e"),e("456d"),e("bd86")),r=(e("ac6a"),function(){return{f:{ssProgress:"",ssResult:""},show:[{text:"实施进度",value:"ssProgress",type:"number",placeholder:"请输入百分比",validate:!0,warn:!1},{text:"实施小结",value:"ssResult",type:"textarea",placeholder:"",validate:!1,warn:!1}]}});function i(a,t){var e=Object.keys(a);return Object.getOwnPropertySymbols&&e.push.apply(e,Object.getOwnPropertySymbols(a)),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),e}function c(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(e,!0).forEach(function(t){Object(o["a"])(a,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):i(e).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))})}return a}var l=[],u={data:function(){return{isEdit:!1,plans:[{titles:"养护标段：",val:""},{titles:"养护内容：",val:""},{titles:"备注：",val:""}],buttons:[{btns:"保存"},{btns:"提交"}],reastData:[],token:JSON.parse(this.getData("userinfo")).data,yhSonData:[],yhZhong:[],allDate:"",type:"",isClose:!1,handleType:!1}},onReady:function(){var a=this;if(a.yhSonData=api.pageParam.SonDatas,a.allDate=api.pageParam.allDate,a.yhDeta=api.pageParam.id,a.isClose=api.pageParam.add,a.plans[0].val=a.yhSonData.maintenanceBiaoduanName,a.plans[1].val=a.yhSonData.maintenanceContents,a.plans[2].val=a.yhSonData.remark,"待处理"===a.yhSonData.ssStatus)a.isEdit=!1;else if("处理中"===a.yhSonData.ssStatus){if(a.isEdit=!1,a.yhSonData.attachList.length>0){var t=[],e=[],n=a.slow.getInterport().host;a.yhSonData.attachList.forEach(function(a){"养护前"===a.remark?t.push(n+"api/profile/"+a.imagePath+a.imageName):"养护后"===a.remark&&e.push(n+"api/profile/"+a.imagePath+a.imageName)}),a.$refs.ocnFile1.addFiles(t),a.$refs.ocnFile2.addFiles(e),l=e,console.log("imgNameafter"+JSON.stringify(e))}}else if("已处理"===a.yhSonData.ssStatus&&(a.isEdit=!0,a.yhSonData.attachList.length>1)){var s=[],o=[],r=a.slow.getInterport().host;a.yhSonData.attachList.forEach(function(a){"养护前"===a.remark?s.push(r+"api/profile/"+a.imagePath+a.imageName):"养护后"===a.remark&&o.push(r+"api/profile/"+a.imagePath+a.imageName)}),a.$refs.ocnFile1.addFiles(s),a.$refs.ocnFile2.addFiles(o),l=o}a.freshForm()},created:function(){this.$nextTick(function(){})},methods:{freshForm:function(){var a=this;a.reastData=r(),a.isEdit?(a.reastData.f=c({},a.reastData.f,{},a.yhSonData),a.reastData.show.forEach(function(t){t.valueShow=a.reastData.f[t.value]}),a.$refs.ocnform.init(a.reastData)):"处理中"===a.yhSonData.ssStatus?(a.reastData.f=c({},a.reastData.f,{ssResult:a.yhSonData.ssResult||"",ssProgress:a.yhSonData.ssProgress||""}),a.reastData.show.forEach(function(t){t.valueShow=a.reastData.f[t.value]}),a.$refs.ocnform.init(a.reastData)):a.reastData.f=Object(o["a"])({ssResult:null},"ssResult",null)},back:function(){window.api&&api.historyBack(function(a,t){a.status||api.closeWin()})},ChangeColor:function(a){var t=this;if(a){if("提交"===t.type)t.$createDialog({type:"confirm",icon:"",title:"确认该子项是否实施完成？",content:"",confirmBtn:{text:"确定",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"取消",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){if(t.reastData.f.ssProgress<100)t.ocn.warn_toast(t).show("计划完成度未达100%，不能提交，只能保存!"),t.handleType=!0;else{if(t.reastData.f.ssProgress>100)return void t.ocn.warn_toast(t).show("计划完成度不可超过100%!");t.$refs.ocnFile2.upload(t.slow.getInterport().host+"api/inspect_manage/uploadImgs?token="+t.token).then(function(a){console.log("rFileh ****** "+JSON.stringify(a));var e=!1,n="";a.success?(e=!0,n=a.data):l.length?e=!0:t.ocn.warn_toast(t).show("图片未上传或上传失败！"),e&&t.post("ws_maintenance_manage/updateYhSsSubtaskStatus",{createTime:t.yhSonData.createTime,createUserId:t.yhSonData.createUserId,delFlag:t.yhSonData.delFlag,id:t.yhSonData.id,maintenanceBiaoduanId:t.yhSonData.maintenanceBiaoduanId,maintenanceBiaoduanName:t.yhSonData.maintenanceBiaoduanName,maintenanceContents:t.yhSonData.maintenanceContents,planId:t.yhSonData.planId,remark:t.yhSonData.remark,ssProgress:t.reastData.f.ssProgress,ssResult:t.reastData.f.ssResult,ssType:"3",updateTime:t.yhSonData.updateTime,updateUserId:t.yhSonData.updateUserId,attacIds:n}).then(function(a){a.success?(t.ocn.warn_toast(t).show("提交成功！"),api.closeWin()):t.ocn.warn_toast(t).show("上传失败！请稍后重试！")})}).catch(function(a){t.ocn.warn_toast(t).show("图片未上传或上传失败！")})}},onCancel:function(){t.$createToast({type:"warn",time:1e3,txt:"已取消"}).show()}}).show();else if("保存"===t.type){if(t.reastData.f.ssProgress>=100)return void t.ocn.warn_toast(t).show("保存，计划完成度不可为100%!");t.handleType?t.$refs.ocnFile2.upload(t.slow.getInterport().host+"api/inspect_manage/uploadImgs?token="+t.token).then(function(a){console.log(JSON.stringify(a)),a.success?t.post("ws_maintenance_manage/updateYhSsSubtaskStatus",{createTime:t.yhSonData.createTime,createUserId:t.yhSonData.createUserId,delFlag:t.yhSonData.delFlag,id:t.yhSonData.id,maintenanceBiaoduanId:t.yhSonData.maintenanceBiaoduanId,maintenanceBiaoduanName:t.yhSonData.maintenanceBiaoduanName,maintenanceContents:t.yhSonData.maintenanceContents,planId:t.yhSonData.planId,remark:t.yhSonData.remark,ssProgress:t.reastData.f.ssProgress,ssResult:t.reastData.f.ssResult,ssType:"2",updateTime:t.yhSonData.updateTime,updateUserId:t.yhSonData.updateUserId,attacIds:a.data}).then(function(a){a.success?(t.ocn.warn_toast(t).show("保存成功！"),api.closeWin()):t.ocn.warn_toast(t).show("上传失败！请稍后重试！")}):t.ocn.warn_toast(t).show("图片未上传或上传失败！")}).catch(function(a){t.ocn.warn_toast(t).show("图片未上传或上传失败！")}):t.$refs.ocnFile1.upload(t.slow.getInterport().host+"api/inspect_manage/uploadImgs?token="+t.token).then(function(a){a.success?t.post("ws_maintenance_manage/updateYhSsSubtaskStatus",{createTime:t.yhSonData.createTime,createUserId:t.yhSonData.createUserId,delFlag:t.yhSonData.delFlag,id:t.yhSonData.id,maintenanceBiaoduanId:t.yhSonData.maintenanceBiaoduanId,maintenanceBiaoduanName:t.yhSonData.maintenanceBiaoduanName,maintenanceContents:t.yhSonData.maintenanceContents,planId:t.yhSonData.planId,remark:t.yhSonData.remark,ssProgress:t.reastData.f.ssProgress,ssResult:t.reastData.f.ssResult,ssType:"2",updateTime:t.yhSonData.updateTime,updateUserId:t.yhSonData.updateUserId,attacIds:a.data}).then(function(a){a.success?(t.ocn.warn_toast(t).show("提交成功！"),api.closeWin()):t.ocn.warn_toast(t).show("上传失败！请稍后重试！")}):t.ocn.warn_toast(t).show("图片未上传或上传失败！")}).catch(function(a){t.ocn.warn_toast(t).show("图片未上传或上传失败！")})}}else t.$refs.ocnform.validate()}}},h=u,d=(e("0d9a"),e("2877")),f=Object(d["a"])(h,n,s,!1,null,"d83d6ebe",null),p=f.exports,m=e("6912");Object(m["a"])(p)}});